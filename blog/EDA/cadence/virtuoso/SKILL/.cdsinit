
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;; Personal .cdsinit ;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
envLoadFile("~/.cdsenv")                         ; 

hiRegTimer("ddsOpenLibManager()" 1)              ; Delayed automatic opening of lib manager
hiResizeWindow(window(1) list(100:150 1500:800)) ; Set the CIW window size, 400:150 and 1200:600 are the screen coordinates.

hiSetFont("ciw"   ?size 14)                      ; CIW font size, greater than 16 is not recommended
hiSetFont("text"  ?size 14)                      ; Toolbar and Menu font size, greater than 16 is not recommended
hiSetFont("label" ?size 14)                      ; simulation font size, greater than 16 is not recommended

hiSetBindKey("explorer"   "Ctrl<Key>N" "_axlAddOutputByTypeCB(_axlGetCurrentSessionDontFail() \"expr\")")
hiSetBindKey("assembler"  "Ctrl<Key>N" "_axlAddOutputByTypeCB(_axlGetCurrentSessionDontFail() \"expr\")")

hiSetBindKey("Schematics" "<Btn4Down>" "hiZoomWindowAtMouse(hiGetCurrentWindow() 1.25)")
hiSetBindKey("Schematics" "<Btn5Down>" "hiZoomWindowAtMouse(hiGetCurrentWindow() 0.8)")
hiSetBindKey("Layout"     "<Btn4Down>" "hiZoomWindowAtMouse(hiGetCurrentWindow() 1.25)")
hiSetBindKey("Layout"     "<Btn5Down>" "hiZoomWindowAtMouse(hiGetCurrentWindow() 0.8)")

hiSetBindKey("Symbol"     "<Key>w"     "schHiCreateSymbolShape("line" "outline")")  ; ref: https://www.thecadforums.com/threads/default-keyboard-shortcuts-not-working-in-schematic-editor.35492/



; ref: https://gist.github.com/02015678/cae341f4262fa73325e30eb925a21659
; 9 to add net probe, SHIFT+9 to delete net probe, CTRL+9 to delete all probe
; Mouse-Btn1 Double click to Descend, Mouse-Btn3 Double click to Return
; when( isCallable(`schGetEnv)
; 	hiSetBindKeys("Schematics" list(
; 		list("<Key>9" 				"geEnterAddNetProbe()"											)
; 		list("<Key>(" 				"geEnterDeleteNetProbe()"										)
; 		list("Ctrl<Key>9" 			"geDeleteAllProbe()"											)
; 		list("None<Btn1Down>(2)" 	"schSingleSelectPt(),schHiDescendRead()" 	"mouseAddPt(t)"		)
; 		list("None<Btn3Down>(2)" 	"schSingleSelectPt(),schHiReturn()" 		"mouseAddPt(t)"		)	
; 	))
; )

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;; layout bindkey ;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
hiSetBindKey("Layout"     "F1"           "if( geGetSelSet() then geHiSetSelProtectionEF() else geHiUnsetSelProtectionEF() )")

procedure(MyMoveSelected(deltax deltay)     ; ref: https://community.cadence.com/cadence_technology_forums/f/custom-ic-skill/36295/bindkey-to-move-selected-object
  let((xform)
    xform = list(deltax:deltay "R0" 1)
    foreach(obj geGetSelSet() dbMoveFig(obj nil xform))    ; Don't move the fig, if the selected obj is label pin. Bacause the label will move with the path, and this for loop will move pins twice. 
  )
)
procedure( movingUnit()
  let( ( ( windowId hiGetCurrentWindow() ) bBox width )
    bBox = hiGetViewBBox( windowId )
    width = xCoord( upperRight( bBox ) ) - xCoord( lowerLeft( bBox ) )

    (cond
      ((lessp width 16) 0.005)  ; todo, get the real grid width
      ((lessp width 80) 0.01)
      ((lessp width 160) 0.05)
      ((lessp width 320) 0.2)
      ((lessp width 640) 0.4)
      (t 1.0)
    )
  )
)
hiSetBindKey("Layout" "Left"  "MyMoveSelected(-10*movingUnit() 0)")
hiSetBindKey("Layout" "Right" "MyMoveSelected(10*movingUnit() 0)")
hiSetBindKey("Layout" "Up"    "MyMoveSelected(0 10*movingUnit())")
hiSetBindKey("Layout" "Down"  "MyMoveSelected(0 -10*movingUnit())")
hiSetBindKey("Layout" "Ctrl<Key>Left"  "MyMoveSelected(-movingUnit() 0)")
hiSetBindKey("Layout" "Ctrl<Key>Right" "MyMoveSelected(movingUnit() 0)")
hiSetBindKey("Layout" "Ctrl<Key>Up"    "MyMoveSelected(0 movingUnit())")
hiSetBindKey("Layout" "Ctrl<Key>Down"  "MyMoveSelected(0 -movingUnit())")



; hidKey("Schematics" "Ctrl Shift <Key>J" "annLoadAnnotationData(hiGetCurrentWindow() \"/home/user/Desktop/prj_20250224/.cadence/dfII/annotationSetups/My_annoSetup.as\")")
; hidKey("Schematics" "Ctrl Shift <Key>M" "annLoadAnnotationData(hiGetCurrentWindow() \"/home/arja/.cadence/TranannotationSetup.as\")")
; https://community.cadence.com/cadence_blogs_8/b/cic/posts/virtuosity-sharing-and-automatically-loading-ade-annotation-settings

; auto load Layout bindkey
; dbSetAutoSave()
